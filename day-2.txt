
- name: configure Jinja2 Template
  hosts: web
  become: yes
  vars_files:
    - vars/main.yaml
  
  tasks:
    - name: Install Nginx
      apt:
        name: nginx
        state: present

    - name: copy jinja2 template to desitnation
      template:
        src: templates/nginx.conf.j2
        dest: /etc/nginx/nginx.conf
        owner: root
        group: root
        mode: '0644'
    
    - name: Restart NGINX
      service:
        name: nginx
        state: started


------------


env: staging
upstream_servers:
  - name: app1
    ip: 10.0.0.10
  - name: app2
    ip: 10.0.0.20
